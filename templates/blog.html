{% extends "base.html" %}
{% block title %}Blog{% endblock %}
{% block content %}

<!-- Hero for Blog -->
<section class="page-hero" style="background-image: url('{{ url_for('static', filename='assets/bloghero.png') }}');">
    <div class="hero-overlay"></div>
    <div class="hero-content">
        <h1>Blog</h1>
        <p>Insights, tutorials, and news from the cybersecurity world.</p>
    </div>
</section>

<!-- Search Bar -->
<div class="search-container">
    <form method="GET" action="{{ url_for('blog') }}">
        <input type="text" name="search" placeholder="Search blog posts..." value="{{ search }}">
        <button type="submit" class="btn primary">Search</button>
    </form>
</div>

<!-- Blog Grid -->
<div class="blog-grid">
    {% for post in posts %}
    <article class="blog-card">
        {% if post.featured_image %}
            <img src="{{ post.featured_image }}" alt="{{ post.title }}" class="card-image">
        {% endif %}
        <div class="card-content">
            <h2><a href="{{ url_for('blog_post', slug=post.slug) }}">{{ post.title }}</a></h2>
            <div class="post-meta">{{ post.date_posted.strftime('%d/%m/%Y') }}</div>
            <div class="tag-list">
                {% if post.tags %}
                    {% for tag in post.tags.split(',') %}
                        <span class="tag">{{ tag.strip() }}</span>
                    {% endfor %}
                {% endif %}
            </div>
            <p class="post-excerpt">{{ post.excerpt or post.content[:150]|striptags }}...</p>
            <a href="{{ url_for('blog_post', slug=post.slug) }}" class="read-more">Read More â†’</a>
        </div>
    </article>
    {% else %}
    <p class="center">No blog posts found.</p>
    {% endfor %}
</div>

<!-- Pagination -->
{% if pagination.pages > 1 %}
<div class="pagination">
    {% if pagination.has_prev %}
        <a href="{{ url_for('blog', page=pagination.prev_num, search=search) }}">&laquo; Previous</a>
    {% endif %}
    {% for page_num in pagination.iter_pages() %}
        {% if page_num %}
            {% if page_num == pagination.page %}
                <strong>{{ page_num }}</strong>
            {% else %}
                <a href="{{ url_for('blog', page=page_num, search=search) }}">{{ page_num }}</a>
            {% endif %}
        {% else %}
            <span>...</span>
        {% endif %}
    {% endfor %}
    {% if pagination.has_next %}
        <a href="{{ url_for('blog', page=pagination.next_num, search=search) }}">Next &raquo;</a>
    {% endif %}
</div>
{% endif %}

{% endblock %}
